!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).GooglePayButton=e()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};var e=function(){return(e=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n(t,e,n,o){var r,a=arguments.length,i=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(i=(a<3?r(i):a>3?r(e,n,i):r(e,n))||i);return a>3&&i&&Object.defineProperty(e,n,i),i}function o(t,e,n,o){return new(n||(n=Promise))((function(r,a){function i(t){try{u(o.next(t))}catch(t){a(t)}}function s(t){try{u(o.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(i,s)}u((o=o.apply(t,e||[])).next())}))}function r(t,e){var n,o,r,a,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}function a(t){return t.replace(/[A-Z]+/g,(function(t){return"-"+t})).replace(/^-/,"").toLowerCase()}function i(t){return function(e,n){var o=t||a(n);e.addObservedAttribute&&e.addObservedAttribute(o),Object.defineProperty(e,n,{get:function(){return this.getAttribute(o)},set:function(t){null==t?this.removeAttribute(o):this.setAttribute(o,t),this.notifyPropertyChanged(n)},enumerable:!0,configurable:!0})}}function s(t){return t?i(t):function(t,e){Object.defineProperty(t,e,{get:function(){return this["$__"+e]},set:function(t){this["$__"+e]=t,this.notifyPropertyChanged(e)},enumerable:!0,configurable:!0})}}function u(t){return function(e,n){Object.defineProperty(e,t,{get:function(){return this[n]},set:function(t){this[n]=t},enumerable:!0,configurable:!1})}}var c={};function l(t){var e=c[t];if(e)return e;var n=new Promise((function(e,n){var o=document.createElement("script");o.src=t,o.async=!0;var r=function(){e()},a=function(){o.removeEventListener("load",r),o.removeEventListener("error",a),delete c[t],o.remove(),n(new Error("Unable to load script "+t))};o.addEventListener("load",r),o.addEventListener("error",a),document.body.appendChild(o)}));return c[t]=n,n}var d=function(){function t(t){var e=this;this.handleClick=function(t){return o(e,void 0,void 0,(function(){var e,n,o,a;return r(this,(function(r){switch(r.label){case 0:if(!(e=this.config))throw new Error("google-pay-button: Missing configuration");n=this.createLoadPaymentDataRequest(e),r.label=1;case 1:return r.trys.push([1,3,,4]),e.onClick&&e.onClick(t),t.defaultPrevented?[2]:[4,this.client.loadPaymentData(n)];case 2:return o=r.sent(),e.onLoadPaymentData&&e.onLoadPaymentData(o),[3,4];case 3:return"CANCELED"===(a=r.sent()).statusCode?e.onCancel&&e.onCancel(a):e.onError?e.onError(a):console.error(a),[3,4];case 4:return[2]}}))}))},this.options=t}return t.prototype.getElement=function(){return this.element},t.prototype.isGooglePayLoaded=function(){var t,e;return"google"in(window||global)&&!!(null===(e=null===(t=null===google||void 0===google?void 0:google.payments)||void 0===t?void 0:t.api)||void 0===e?void 0:e.PaymentsClient)},t.prototype.mount=function(t){return o(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return this.isGooglePayLoaded()?[3,2]:[4,l("https://pay.google.com/gp/p/js/pay.js")];case 1:e.sent(),e.label=2;case 2:return this.element=t,t&&(this.appendStyles(),this.config&&this.updateElement()),[2]}}))}))},t.prototype.unmount=function(){this.element=void 0},t.prototype.configure=function(t){var e=void 0;return this.config=t,this.oldInvalidationValues&&!this.isClientInvalidated(t)||(e=this.updateElement()),this.oldInvalidationValues=this.getInvalidationValues(t),null!=e?e:Promise.resolve()},t.prototype.createClientOptions=function(t){var e={environment:t.environment,merchantInfo:this.createMerchantInfo(t)};return(t.onPaymentDataChanged||t.onPaymentAuthorized)&&(e.paymentDataCallbacks={},t.onPaymentDataChanged&&(e.paymentDataCallbacks.onPaymentDataChanged=function(e){return t.onPaymentDataChanged(e)||{}}),t.onPaymentAuthorized&&(e.paymentDataCallbacks.onPaymentAuthorized=function(e){return t.onPaymentAuthorized(e)||{}})),e},t.prototype.createIsReadyToPayRequest=function(t){var e=t.paymentRequest;return{apiVersion:e.apiVersion,apiVersionMinor:e.apiVersionMinor,allowedPaymentMethods:e.allowedPaymentMethods,existingPaymentMethodRequired:t.existingPaymentMethodRequired}},t.prototype.createLoadPaymentDataRequest=function(t){return e(e({},t.paymentRequest),{merchantInfo:this.createMerchantInfo(t)})},t.prototype.createMerchantInfo=function(t){var n=e({},t.paymentRequest.merchantInfo);return n.softwareInfo||(n.softwareInfo={id:this.options.softwareInfoId,version:this.options.softwareInfoVersion}),n},t.prototype.isMounted=function(){return null!=this.element&&!1!==this.element.isConnected},t.prototype.removeButton=function(){if(this.element instanceof ShadowRoot||this.element instanceof Element)for(var t=0,e=Array.from(this.element.children);t<e.length;t++){var n=e[t];"STYLE"!==n.tagName&&n.remove()}},t.prototype.updateElement=function(){return o(this,void 0,void 0,(function(){var t,e,n,o,a,i,s,u;return r(this,(function(r){switch(r.label){case 0:if(!this.isMounted())return[2];if(t=this.getElement(),!this.config)throw new Error("google-pay-button: Missing configuration");this.removeButton(),this.client=new google.payments.api.PaymentsClient(this.createClientOptions(this.config)),e={buttonType:this.config.buttonType,buttonColor:this.config.buttonColor,buttonSizeMode:this.config.buttonSizeMode,buttonLocale:this.config.buttonLocale,onClick:this.handleClick,allowedPaymentMethods:this.config.paymentRequest.allowedPaymentMethods},(n=t.getRootNode())instanceof ShadowRoot&&(e.buttonRootNode=n),o=this.client.createButton(e),this.setClassName(t,[t.className,"not-ready"]),t.appendChild(o),a=!1,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.client.isReadyToPay(this.createIsReadyToPayRequest(this.config))];case 2:return i=r.sent(),a=i.result&&!this.config.existingPaymentMethodRequired||i.result&&i.paymentMethodPresent&&this.config.existingPaymentMethodRequired||!1,[3,4];case 3:return s=r.sent(),this.config.onError?this.config.onError(s):console.error(s),[3,4];case 4:if(!this.isMounted())return[2];if(a){try{this.client.prefetchPaymentData(this.createLoadPaymentDataRequest(this.config))}catch(t){console.log("Error with prefetch",t)}this.setClassName(t,(t.className||"").split(" ").filter((function(t){return t&&"not-ready"!==t})))}return this.isReadyToPay===(null==i?void 0:i.result)&&this.paymentMethodPresent===(null==i?void 0:i.paymentMethodPresent)||(this.isReadyToPay=!!(null==i?void 0:i.result),this.paymentMethodPresent=null==i?void 0:i.paymentMethodPresent,this.config.onReadyToPayChange&&(u={isButtonVisible:a,isReadyToPay:this.isReadyToPay},this.paymentMethodPresent&&(u.paymentMethodPresent=this.paymentMethodPresent),this.config.onReadyToPayChange(u))),[2]}}))}))},t.prototype.setClassName=function(t,e){var n=e.filter((function(t){return t})).join(" ");n?t.className=n:t.removeAttribute("class")},t.prototype.appendStyles=function(){var t,e,n;if("undefined"!=typeof document){var o=null===(t=this.element)||void 0===t?void 0:t.getRootNode(),r="default-google-style-"+this.options.cssSelector.replace(/[^\w-]+/g,"")+"-"+(null===(e=this.config)||void 0===e?void 0:e.buttonLocale);if(o&&!(null===(n=o.getElementById)||void 0===n?void 0:n.call(o,r))){var a=document.createElement("style");a.id=r,a.type="text/css",a.innerHTML="\n          "+this.options.cssSelector+" {\n            display: inline-block;\n          }\n          "+this.options.cssSelector+".not-ready {\n            width: 0;\n            height: 0;\n            overflow: hidden;\n          }\n        ",o instanceof Document&&o.head?o.head.appendChild(a):o.appendChild(a)}}},t.prototype.isClientInvalidated=function(t){var e=this;return!this.oldInvalidationValues||this.getInvalidationValues(t).some((function(t,n){return t!==e.oldInvalidationValues[n]}))},t.prototype.getInvalidationValues=function(t){var e,n;return[t.environment,t.existingPaymentMethodRequired,!!t.onPaymentDataChanged,!!t.onPaymentAuthorized,t.buttonColor,t.buttonType,t.buttonLocale,t.buttonSizeMode,t.paymentRequest.merchantInfo.merchantId,t.paymentRequest.merchantInfo.merchantName,null===(e=t.paymentRequest.merchantInfo.softwareInfo)||void 0===e?void 0:e.id,null===(n=t.paymentRequest.merchantInfo.softwareInfo)||void 0===n?void 0:n.version,t.paymentRequest.allowedPaymentMethods]},t}(),p="@google-pay/button-element";function y(t,e){var n;return void 0===e&&(e=0),function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];window.clearTimeout(n);var a=function(){return n=void 0,t.apply(void 0,o)};return new Promise((function(t){n=window.setTimeout((function(){var e=a();t(e)}),e)}))}}var h=function(e){function c(){var t=null!==e&&e.apply(this,arguments)||this;return t.manager=new d({cssSelector:"google-pay-button",softwareInfoId:p,softwareInfoVersion:"3.0.0"}),t.initializeButton=y((function(){if(t.assertRequiredProperty("paymentRequest")&&t.assertRequiredProperty("environment")){var e={paymentRequest:t.paymentRequest,environment:t.environment,existingPaymentMethodRequired:t.existingPaymentMethodRequired,onPaymentDataChanged:t.onPaymentDataChanged,onPaymentAuthorized:t.onPaymentAuthorized,buttonColor:t.buttonColor,buttonType:t.buttonType,buttonSizeMode:t.buttonSizeMode,buttonLocale:t.buttonLocale,onReadyToPayChange:function(e){t.onReadyToPayChange&&t.onReadyToPayChange(e),t.dispatch("readytopaychange",e)},onCancel:function(e){t.onCancel&&t.onCancel(e),t.dispatch("cancel",e)},onError:function(e){var n;t.onError&&(null===(n=t.onError)||void 0===n||n.call(t,e)),t.dispatchEvent(new ErrorEvent("error",{error:e}))},onLoadPaymentData:function(e){t.onLoadPaymentData&&t.onLoadPaymentData(e),t.dispatch("loadpaymentdata",e)},onClick:function(e){var n;t.onClick&&(null===(n=t.onClick)||void 0===n||n.call(t,e))}};t.manager.configure(e)}})),t}var l;return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}(c,e),Object.defineProperty(c.prototype,"isReadyToPay",{get:function(){return this.manager.isReadyToPay},enumerable:!1,configurable:!0}),c.prototype.assertRequiredProperty=function(t){var e=this[t];return null!=e||(this.throwError(Error("Required property not set: "+t)),!1)},c.prototype.throwError=function(t){throw t},Object.defineProperty(c,"observedAttributes",{get:function(){return c._observedAttributes},enumerable:!1,configurable:!0}),c.prototype.addObservedAttribute=function(t){c._observedAttributes.push(t)},c.prototype.dispatch=function(t,e){this.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!1,detail:e}))},c.prototype.connectedCallback=function(){return o(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,this.manager.mount(this)];case 1:return t.sent(),[2,this.initializeButton()]}}))}))},c.prototype.disconnectedCallback=function(){this.manager.unmount()},c.prototype.attributeChangedCallback=function(t){return this.initializeButton()},c.prototype.notifyPropertyChanged=function(t){return this.initializeButton()},c._observedAttributes=[],n([s(),u("paymentrequest")],c.prototype,"paymentRequest",void 0),n([i()],c.prototype,"environment",void 0),n([function(t,e){var n=l||a(e);t.addObservedAttribute&&t.addObservedAttribute(n),Object.defineProperty(t,e,{get:function(){return this.hasAttribute(n)},set:function(t){t?this.setAttribute(n,""):this.removeAttribute(n),this.notifyPropertyChanged(e)},enumerable:!0,configurable:!0})},u("existingpaymentmethodrequired")],c.prototype,"existingPaymentMethodRequired",void 0),n([i(),u("buttoncolor")],c.prototype,"buttonColor",void 0),n([i(),u("buttontype")],c.prototype,"buttonType",void 0),n([i(),u("buttonsizemode")],c.prototype,"buttonSizeMode",void 0),n([i(),u("buttonlocale")],c.prototype,"buttonLocale",void 0),n([s(),u("paymentDataChangedCallback"),u("paymentdatachangedcallback"),u("onpaymentdatachanged")],c.prototype,"onPaymentDataChanged",void 0),n([s(),u("paymentAuthorizedCallback"),u("paymentauthorizedcallback"),u("onpaymentauthorized")],c.prototype,"onPaymentAuthorized",void 0),n([u("readyToPayChangeCallback"),u("readytopaychangecallback"),u("onreadytopaychange")],c.prototype,"onReadyToPayChange",void 0),n([u("loadPaymentDataCallback"),u("loadpaymentdatacallback"),u("onloadpaymentdata")],c.prototype,"onLoadPaymentData",void 0),n([u("cancelCallback"),u("cancelcallback"),u("oncancel")],c.prototype,"onCancel",void 0),n([u("errorCallback"),u("errorcallback"),u("onerror")],c.prototype,"onError",void 0),n([u("clickCallback"),u("clickcallback"),u("onclick")],c.prototype,"onClick",void 0),c}(HTMLElement);return customElements.define("google-pay-button",h),h}));
